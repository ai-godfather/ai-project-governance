# WORKFLOW ENFORCEMENT ‚Äî MANDATORY

> **Priority**: SUPREME ‚Äî applies to ALL interactions  
> **Version**: 2.0.0

---

## üî¥ BEFORE ANY IMPLEMENTATION

Agent MUST verify these conditions BEFORE writing code:

| Step | Check | If NO |
|------|-------|-------|
| 1 | Feature plan exists in `.ai/plans/features/` | ‚Üí `@workflow PLANNER` |
| 2 | AUDITOR passed (check `_PLANS_VALIDATIONS/`) | ‚Üí `@workflow AUDITOR <CODE>` |
| 3 | Tests exist for module | ‚Üí Run existing tests first |

```
‚ùå FORBIDDEN: Implement without plan
‚ùå FORBIDDEN: Implement without AUDITOR pass
‚ùå FORBIDDEN: Skip TDD check
```

---

## üî¥ TWO-PHASE PLANNER (v2.0)

When creating features, PLANNER MUST:

```
PHASE 1: Create plan file
        ‚Üì
        Output: "Plan ready for review. Approve to generate tasks."
        ‚Üì
        üõë STOP ‚Äî WAIT FOR USER APPROVAL
        ‚Üì
[USER SAYS: "ok", "approve", "proceed", "yes"]
        ‚Üì
PHASE 2: Generate task files + update TASK_INDEX
```

```
‚ùå FORBIDDEN: Generate tasks without user approval
‚ùå FORBIDDEN: Skip Phase 1 approval gate
```

---

## üî¥ AFTER EACH TASK COMPLETION

Agent MUST do these IMMEDIATELY after completing each task:

| Step | Action | File |
|------|--------|------|
| 1 | Update task status to `completed` | `task*.md` |
| 2 | Update TASK_INDEX.md | `.ai/TASK_INDEX.md` or feature index |
| 3 | Add changelog entry | `.ai/CHANGELOGS/{{DATE}}.snapshot.md` |

```
‚ùå FORBIDDEN: Proceed to next task without updating TASK_INDEX (FP-068)
‚ùå FORBIDDEN: Batch status updates at end of session
‚ùå FORBIDDEN: Skip changelog entry
```

---

## üî¥ BEFORE EVERY COMMIT

Run this checklist BEFORE committing:

```bash
# 1. Linter
{{LINTER_COMMAND}}

# 2. Container/config lint (if applicable)
{{CONTAINER_LINT_COMMAND}}

# 3. Template lint (if applicable)
{{TEMPLATE_LINT_COMMAND}}
```

| Check | Expected | If FAIL |
|-------|----------|---------|
| Linter | 0 errors | Fix before commit |
| Config | OK | Fix before commit |
| TASK_INDEX | All completed marked ‚úÖ | Update index |
| Changelog | Today's entry exists | Add entry |

```
‚ùå FORBIDDEN: Commit with failing checks
‚ùå FORBIDDEN: Commit without changelog update
```

---

## üìã QUICK REFERENCE: Workflow Commands

| Command | When to Use |
|---------|-------------|
| `@workflow PLANNER` | New feature request |
| `@workflow AUDITOR <CODE>` | Before implementation |
| `@workflow TDD_GUIDE <TASK>` | Create failing tests (optional) |
| `@workflow IMPLEMENTER <CODE>` | Execute plan |
| `@workflow VALIDATOR` | First-pass validation |
| `@workflow FIXATOR` | Fix BLOCK issues |
| `@workflow RE_VALIDATOR` | Verify fixes |

---

## üéØ EXECUTION ORDER

```
1. PLANNER Phase 1 ‚Üí [USER APPROVAL] ‚Üí Phase 2
2. AUDITOR (Quality Gate)
3. TDD_GUIDE [optional]
4. IMPLEMENTER
5. VALIDATOR ‚Üí UI_INSPECTOR ‚Üí DATA_SEMANTIC_VALIDATOR
6. FIXATOR (if BLOCK)
7. RE_VALIDATOR
```

---

**Violation of any rule above = WORKFLOW BREACH**
